jQuery(document).ready(function ($) {
    var $sidebarC = $('.sidebar-content:eq(0)'),
        $sidebar = $('.sidebar:eq(0)'),
        scH, sO, sH, sC, wH, canScroll, mustBeFixedAtScreen, mustBeFixedAtBottom;
    if ( $sidebar.size() ) {
        function wdefineScreenVars() {
            scH = $sidebarC.innerHeight();
            sO = $sidebar.offset().top;
            sH = $sidebar.innerHeight();
            wscrollScreen();
        }
        $(window).on('resize', wdefineScreenVars);
        wdefineScreenVars();
        setTimeout(wdefineScreenVars, 800);
        setTimeout(wdefineScreenVars, 1200);
        setTimeout(wdefineScreenVars, 2000);
        setTimeout(wdefineScreenVars, 3000);
        setTimeout(wdefineScreenVars, 4000);

        function wscrollScreen() {
            sc = $(window).scrollTop();
            wH = $(window).height();
            canScroll = scH < sH;
            mustBeFixedAtScreen = canScroll && ((sO + scH) <= (sc + wH));
            mustBeFixedAtBottom = mustBeFixedAtScreen && ((sc + wH) >= (sO + sH));
            $sidebarC.toggleClass('fixed-at-screen', mustBeFixedAtScreen && !mustBeFixedAtBottom);
            $sidebarC.toggleClass('fixed-at-bottom', mustBeFixedAtBottom);
        }
        $(window).on('scroll', wscrollScreen);
    }
    $('a[href$=".jpg"],a[href$=".png"]').simpleLightbox(); var $commentsPagination = $('.comments-pagination'); if ($commentsPagination.length) { $commentsPagination.on('click', function () { $('.hidden-comment').show(); $commentsPagination.hide() }) }
    $(document).on('click', '#button-search', function (e) { e.preventDefault(); $('#search-form-wrapper').toggleClass('visible') }); var $forumList = $('.forum-subject-list'); if ($forumList.length) {
        var $currentFl = $forumList.find('.forum-item').eq(0).addClass('current'); $forumList.find('.forum-item:gt(0)').hide(); setInterval(function () {
            $currentFl.hide().removeClass('current'); $currentFl = $currentFl.next('.forum-item'); if ($currentFl.length == 0) { $currentFl = $forumList.find('.forum-item').eq(0) }
            $currentFl.show().addClass('current')
        }, 5000)
    }
    $(document).on('submit', '#newsletter-subscribe', function (e) {
        e.preventDefault(); $self = $(this); var email = $self.find('[name="email"]').eq(0).val(), lang = $self.find('[name="lang"]').eq(0).val(); $.ajax({
            method: 'POST', url: willyScript.ajaxUrl, data: { email: email, lang: lang, action: 'newsletter.user.add', }, success: function (data) {
                if (data === !0) { var message = willyScript.text.newsletterwait; $self.find('[name="email"]').eq(0).val('') } else if (data) { var message = willyScript.text.newsletterok; $self.find('[name="email"]').eq(0).val('') } else { var message = willyScript.text.newslettererror; $self.find('[name="email"]').eq(0).focus() }
                $self.find('.message').remove(); $('<div class="message">' + message + '</div>').appendTo('#newsletter-subscribe')
            }
        })
    }); var $playerWrapper = $('#player'); if ($playerWrapper.length) { $('<div id="player-youtube"/><div id="player-dailymotion"/>').appendTo($playerWrapper); window.idVideo = $playerWrapper.attr('data-video'); window.videoService = $playerWrapper.attr('data-player'); var tag = document.createElement('script'); tag.src = 'https://www.youtube.com/iframe_api'; var firstScriptTag = document.getElementsByTagName('script')[0]; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); var tag = document.createElement('script'); tag.src = 'https://api.dmcdn.net/all.js'; var firstScriptTag = document.getElementsByTagName('script')[0]; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); $('.player-play').on('click', function () { var video = $(this).data('video'); var service = $(this).data('service'); loadVideo(video, service); $('html, body').animate({ scrollTop: $("#content-wrapper").offset().top }, 500) }) }
    var scrollPos, mHeight, $header = $('#header'); function setScrollVars() { mHeight = $('#logo-wrapper').height() }
    function scrollScreen() { scrollPos = $(window).scrollTop(); if (scrollPos <= mHeight) { $header.css({ 'transform': 'translateY(-' + scrollPos + 'px)' }) } else { $header.css({ 'transform': 'translateY(-' + mHeight + 'px)' }) } }
    $(window).on('scroll', scrollScreen); $(window).on('resize', setScrollVars); setScrollVars(); scrollScreen(); $('#burger-button').on('click', function (e) { e.preventDefault(); $('body').toggleClass('menu-visible') })
    function formatCartouche(elem) {
        if (typeof elem._embedded['wp:featuredmedia'] == 'undefined') { return '' }
        var thumbnail = elem._embedded['wp:featuredmedia'][0].media_details.sizes.grid320; if (typeof thumbnail == 'undefined') { thumbnail = elem._embedded['wp:featuredmedia'][0].media_details.sizes.full }
        var category = elem._embedded['wp:term'][0]; category.sort(function (a, b) { return b.id - a.id }); category = category[0]; var out = '<div class="cartouche grid-item ' + category.slug + '">\
				<article class="article">\
					<div class="bloc-titre">\
						<a href="'+ elem.link + '"><h2 class="h2">' + elem.title.rendered + '</h2></a>\
                    </div>\
                    <a href="'+ category.link + '" class="category">' + category.name + '</a>\
                    <figure class="image-fit-container"> \
                        <div class="image-fit"><img width="'+ thumbnail.width + '" height="' + thumbnail.height + '" src="' + thumbnail.source_url + '"></div>\
					</figure > \
				</article>\
			</div>'; return out
    }
    function getPostsPage(page, orig, cat) { var q = willyScript.homeUrl + '/wp-json/wp/v2/posts?per_page=6&_embed=1&lang=' + willyScript.lang + '&categories=' + cat + '&filter[meta_query][_thumbnail_id]&page=' + page; $.ajax({ url: q, method: 'get', dataType: 'json', success: function (data) { $('#ajouter-articles').attr('data-page', parseInt(page) + 1); var formattedOutput = $(data.map(formatCartouche).join('')); $('#actus-wrapper').append(formattedOutput); return page } }) }
    $ajarticles = $('#ajouter-articles'); if ($ajarticles.length) { $ajarticles.on('click', function (e) { e.preventDefault(); var page = $(this).attr('data-page'),cat = $(this).attr('data-cat'); getPostsPage(page, $ajarticles,cat) }) }
}); var playerDM; function dmAsyncInit() { playerDM = DM.player(document.getElementById('player-dailymotion'), { width: "100%", height: "100%", params: { autoplay: !1, mute: !0 } }); var playerWrapper = document.getElementById('player'); if ('dailymotion' == playerWrapper.dataset.player) { loadVideo(playerWrapper.dataset.video, 'dailymotion', !0) } }
var playerYT; function onYouTubeIframeAPIReady() { playerYT = new YT.Player('player-youtube', { height: "100%", width: "100%", showinfo: 0, events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange } }) }
function onPlayerReady(event) { var playerWrapper = document.getElementById('player'); if ('youtube' == playerWrapper.dataset.player) { loadVideo(playerWrapper.dataset.video, 'youtube', !0) } }
var done = !1; function onPlayerStateChange(event) { done = !0 }
function stopVideo() { playerYT.stopVideo(); playerDM.pause() }
function loadVideo(id, service, newInst) {
    if (typeof newInst == 'undefined') { var newInst = !1 }
    if (!newInst) { stopVideo() }
    var pDM = document.getElementById('player-dailymotion'), pYT = document.getElementById('player-youtube'); if ('youtube' == service) { pDM.style.display = 'none'; pYT.style.display = 'block'; if (newInst) { playerYT.cueVideoById(id) } else { playerYT.loadVideoById(id) } } else { pYT.style.display = 'none'; pDM.style.display = 'block'; playerDM.load(id, { autoplay: !newInst, }) }
}